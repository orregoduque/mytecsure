{% extends "base.html" %}
{% load bootstrap3 %}


{% block content %}
<div class="container">
    <div class="col-xs-12 col-xs-offset-0 col-sm-offset-2 col-sm-8 col-md-offset-4 col-md-4 col-lg-4 col-lg-offset-4">
        <h2>Agregar Eventos</h2>
        <form method="POST">
            {% csrf_token %}
            {% bootstrap_form form %}
            <input type="submit" value="Create" class="btn btn-default">
        </form>
    </div>
</div>

<div class="col-xs-12 col-xs-offset-0 col-sm-offset-1 col-sm-4 col-md-offset-2 col-md-4 col-lg-4 col-lg-offset-3">
    <button id = "find-me" class="btn btn-primary pull-center">Obtener Ubicacion</button>
    <br>
    <p id = "status"></p>
    <a id = "map-link" target="_blank"></a>
    <p id = "punto"></p>
    <p id = "lugar"></p>
</div>


<div>
    <script>
        function geoFindMe() 
        {
            const status = document.querySelector('#status');
            const mapLink = document.querySelector('#map-link');

            const punto = document.querySelector('#punto');//
            const lugar = document.querySelector('#lugar');//

            mapLink.href = '';
            mapLink.textContent = '';

            function success(position) 
            {
                const latitude  = position.coords.latitude;
                const longitude = position.coords.longitude;
                const lat = '{{coordenadas}}' ;
                //const long = '{{coordenadas}}' ;

                const distancia = 8;
                status.textContent = '';
                punto.textContent = '{{coordenadas}}';//
                lugar.textContent = latitude;//
                
                mapLink.href = `https://www.google.com/maps?q=${latitude},${longitude}`;
                mapLink.textContent = `Ubicacion calculada!`;
            }
            
            function error() {
                status.textContent = 'Unable to retrieve your location';
            }

            if(!navigator.geolocation) {
                status.textContent = 'Geolocation is not supported by your browser';
            } else {
                status.textContent = 'Locatingâ€¦';
                navigator.geolocation.getCurrentPosition(success, error);
            }

        }

        function pay()
        {
            alert('hola');
        }

        document.querySelector('#find-me').addEventListener('click', geoFindMe);


    </script>


</div>
{% endblock %}